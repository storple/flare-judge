{% load static %}
<!-- <header class="flex bg-gray-800"> -->
<header>
    <nav class="bg-background-900"
        x-data="{
            open: false,
            toggle() {
                this.open = ! this.open
            },
            close(focusAfter) {
                this.open = false

                focusAfter && focusAfter.focus()
            }
        }"
        >
        <div class="mx-auto max-w-screen-2xl px-4 sm:px-6 lg:px-8">
            <div class="flex h-20 items-center justify-between">
                <div class="flex items-center">
                    <a href="{% url 'home' %}"
                        class="flex items-center">
                        <img src="{% static 'base/flarelogo.png' %}"
                        alt="Flare Logo"
                        class="h-16 w-16">
                        <h1
                            class="text-xl font-bold text-text-100 ml-1"
                            >Flare</h1>
                    </a>
                    {% comment %}
                    hidden md:block makes it hide on mobile
                    {% endcomment %}
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a href="{% url 'problems' %}"
                                hx-get="{% url 'problems' %}" hx-target="main" hx-push-url="true"
                                class="bg-accent-600 text-text-100 rounded-md px-3 py-2 text-sm font-bold aria-current="page"
                                >Problems</a>
                            <a href="{% url 'learn' %}"
                                hx-get="{% url 'learn' %}" hx-target="main" hx-push-url="true"
                                class="dark:text-text-300 dark:hover:bg-accent-800 dark:hover:text-text-100 rounded-md px-3 py-2 text-sm font-medium" 
                                >Learn</a>
                        </div>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center md:ml-6">

                        <!-- Profile dropdown -->
                        <div
                            class="relative ml-3"
                            @keydown.escape.prevent.stop="close($refs.button)"
                            @focusin.window="! $refs.user_menu_items.contains($event.target) && close()"
                            >
                            <button
                                x-ref="button"
                                @click="toggle()"
                                type="button"
                                class="relative flex max-w-xs items-center rounded-full bg-background-200 dark:bg-background-900 text-sm focus:outline-none focus:bg-background-900 focus:ring-2 focus:ring-text-100 focus:ring-offset-2 focus:ring-offset-background-900"
                                id="user-menu-button"
                                x-bind:aria-expanded="open"
                                aria-haspopup="true">

                                {% if user.is_authenticated %}
                                <span class="mr-2 ml-1 text-text-light dark:text-text-100">{{ user.username }}</span>
                                {% endif %}
                                <span class="absolute -inset-1.5"></span>
                                <svg class="h-8 w-8 rounded-full fill-text-300 hover:fill-text-950 dark:hover:fill-text-100" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 12C22 6.49 17.51 2 12 2C6.49 2 2 6.49 2 12C2 14.9 3.25 17.51 5.23 19.34C5.23 19.35 5.23 19.35 5.22 19.36C5.32 19.46 5.44 19.54 5.54 19.63C5.6 19.68 5.65 19.73 5.71 19.77C5.89 19.92 6.09 20.06 6.28 20.2C6.35 20.25 6.41 20.29 6.48 20.34C6.67 20.47 6.87 20.59 7.08 20.7C7.15 20.74 7.23 20.79 7.3 20.83C7.5 20.94 7.71 21.04 7.93 21.13C8.01 21.17 8.09 21.21 8.17 21.24C8.39 21.33 8.61 21.41 8.83 21.48C8.91 21.51 8.99 21.54 9.07 21.56C9.31 21.63 9.55 21.69 9.79 21.75C9.86 21.77 9.93 21.79 10.01 21.8C10.29 21.86 10.57 21.9 10.86 21.93C10.9 21.93 10.94 21.94 10.98 21.95C11.32 21.98 11.66 22 12 22C12.34 22 12.68 21.98 13.01 21.95C13.05 21.95 13.09 21.94 13.13 21.93C13.42 21.9 13.7 21.86 13.98 21.8C14.05 21.79 14.12 21.76 14.2 21.75C14.44 21.69 14.69 21.64 14.92 21.56C15 21.53 15.08 21.5 15.16 21.48C15.38 21.4 15.61 21.33 15.82 21.24C15.9 21.21 15.98 21.17 16.06 21.13C16.27 21.04 16.48 20.94 16.69 20.83C16.77 20.79 16.84 20.74 16.91 20.7C17.11 20.58 17.31 20.47 17.51 20.34C17.58 20.3 17.64 20.25 17.71 20.2C17.91 20.06 18.1 19.92 18.28 19.77C18.34 19.72 18.39 19.67 18.45 19.63C18.56 19.54 18.67 19.45 18.77 19.36C18.77 19.35 18.77 19.35 18.76 19.34C20.75 17.51 22 14.9 22 12ZM16.94 16.97C14.23 15.15 9.79 15.15 7.06 16.97C6.62 17.26 6.26 17.6 5.96 17.97C4.44 16.43 3.5 14.32 3.5 12C3.5 7.31 7.31 3.5 12 3.5C16.69 3.5 20.5 7.31 20.5 12C20.5 14.32 19.56 16.43 18.04 17.97C17.75 17.6 17.38 17.26 16.94 16.97Z"></path>
                                    <path d="M12 6.92969C9.93 6.92969 8.25 8.60969 8.25 10.6797C8.25 12.7097 9.84 14.3597 11.95 14.4197C11.98 14.4197 12.02 14.4197 12.04 14.4197C12.06 14.4197 12.09 14.4197 12.11 14.4197C12.12 14.4197 12.13 14.4197 12.13 14.4197C14.15 14.3497 15.74 12.7097 15.75 10.6797C15.75 8.60969 14.07 6.92969 12 6.92969Z"></path>
                                </svg>
                            </button>
                            <div
                                x-ref="user_menu_items"
                                x-show="open"
                                @click.outside="close($refs.button)"
                                style="display: none"

                                x-transition:enter="transition ease-out duration-100"
                                x-transition:enter-start="transform opacity-0 scale-95"
                                x-transition:enter-end="transform opacity-100 scale-100"

                                x-transition:leave="transition ease-in duration-75"
                                x-transition:leave-start="transform opacity-100 scale-100"
                                x-transition:leave-end="transform opacity-0 scale-95"

                                class="absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-background-50 dark:bg-background-900 py-1 shadow-lg dark:shadow-background-800 ring-1 ring-background-700 ring-opacity-5 focus:outline-none"
                                role="menu"
                                aria-orientation="vertical"
                                aria-labelledby="user-menu-button"
                                >
                                {% if user.is_authenticated %}
                                <a href="{% url 'profile' %}" hx-get="{% url 'profile' %}" hx-target="main" hx-push-url="true" class="block px-4 py-2 text-sm text-text-800 dark:text-text-200 dark:focus:bg-background-700 hover:bg-background-200 dark:hover:bg-background-800">Profile</a>
                                <a href="{% url 'profile' %}" hx-get="{% url 'profile' %}" hx-target="main" hx-push-url="true" class="block px-4 py-2 text-sm text-text-800 dark:text-text-200 dark:focus:bg-background-700 hover:bg-background-200 dark:hover:bg-background-800">Settings</a>
                                <a href="{% url 'logout' %}"  hx-get="{% url 'logout' %}"  hx-target="main" hx-push-url="true" class="block px-4 py-2 text-sm text-text-800 dark:text-text-200 dark:focus:bg-background-700 hover:bg-background-200 dark:hover:bg-background-800">Sign out</a>
        
                                {% else %}
                                <a href="{% url 'login' %}"          hx-get="{% url 'login' %}" hx-target="main" hx-push-url="true" class="block px-4 py-2 text-sm text-text-800 dark:text-text-200 dark:focus:bg-background-700 hover:bg-background-200 dark:hover:bg-background-800">Log In</a>
                                <a href="{% url 'create_profile' %}" hx-get="{% url 'create_profile' %}" hx-target="main" hx-push-url="true" class="block px-4 py-2 text-sm text-text-800 dark:text-text-200 dark:focus:bg-background-700 hover:bg-background-200 dark:hover:bg-background-800">Sign Up</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="-mr-2 flex md:hidden">
                    <!-- Mobile menu button -->
                    <button
                        type="button"
                        class="relative inline-flex items-center justify-center rounded-md dark:bg-background-800 p-2 text-text-300 dark:hover:bg-background-700 dark:hover:text-text-100 focus:outline-none focus:ring-2 focus:ring-text-100 focus:ring-offset-2 focus:ring-offset-background-900"
                        @click="toggle()"


                        aria-controls="mobile-menu"
                        x-bind:aria-expanded="open">
                        <span class="absolute -inset-0.5"></span>
                        <span class="sr-only">Open main menu</span>
                        <!-- Menu open: "hidden", Menu closed: "block" -->
                        <svg class="block h-6 w-6 stroke-current fill-none"
                            :class="{'hidden': open, 'block': !(open)}"
                            viewBox="0 0 24 24" stroke-width="1.5" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                        </svg>
                        <!-- Menu open: "block", Menudark: '#0e7490' closed: "hidden" -->
                        <svg class="hidden h-6 w-6 stroke-current fill-none"
                            :class="{'hidden': !(open), 'block': open}"
                            fill="none"
                            viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile menu, show/hide based on menu state. -->
        <div class="md:hidden" id="mobile-menu"
            x-show="open"
            x-transition:enter="transition ease-out duration-100"
            x-transition:enter-start="transform opacity-0"
            x-transition:enter-end="transform opacity-100"

            x-transition:leave="transition ease-in duration-75"
            x-transition:leave-start="transform opacity-100"
            x-transition:leave-end="transform opacity-0"
            >
            <div class="space-y-1 px-2 pb-3 pt-2 sm:px-3">
                <!-- Current: "bg-gray-900 text-text-100", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
                <a href="{% url 'problems' %}"
                    hx-get="{% url 'problems' %}" hx-target="main" hx-push-url="true"
                    class="bg-accent-100 dark:bg-accent-600 text-text-100 block rounded-md px-3 py-2 text-base font-medium" aria-current="page">Problems</a>
                <a href="{% url 'learn' %}"
                    hx-get="{% url 'learn' %}" hx-target="main" hx-push-url="true"
                    class="text-text-700 dark:text-text-300 hover:bg-accent-200 dark:hover:bg-accent-800 dark:hover:text-text-100 block rounded-md px-3 py-2 text-base font-medium">Learn</a>
            </div>
            <div class="border-t border-background-700 pb-3 pt-4">
                {% if user.is_authenticated %}
                <div class="flex items-center px-5">
                    <div class="flex-shrink-0">
                        <svg class="h-8 w-8 rounded-full fill-text-300 hover:fill-text-950 dark:hover:fill-text-100" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 12C22 6.49 17.51 2 12 2C6.49 2 2 6.49 2 12C2 14.9 3.25 17.51 5.23 19.34C5.23 19.35 5.23 19.35 5.22 19.36C5.32 19.46 5.44 19.54 5.54 19.63C5.6 19.68 5.65 19.73 5.71 19.77C5.89 19.92 6.09 20.06 6.28 20.2C6.35 20.25 6.41 20.29 6.48 20.34C6.67 20.47 6.87 20.59 7.08 20.7C7.15 20.74 7.23 20.79 7.3 20.83C7.5 20.94 7.71 21.04 7.93 21.13C8.01 21.17 8.09 21.21 8.17 21.24C8.39 21.33 8.61 21.41 8.83 21.48C8.91 21.51 8.99 21.54 9.07 21.56C9.31 21.63 9.55 21.69 9.79 21.75C9.86 21.77 9.93 21.79 10.01 21.8C10.29 21.86 10.57 21.9 10.86 21.93C10.9 21.93 10.94 21.94 10.98 21.95C11.32 21.98 11.66 22 12 22C12.34 22 12.68 21.98 13.01 21.95C13.05 21.95 13.09 21.94 13.13 21.93C13.42 21.9 13.7 21.86 13.98 21.8C14.05 21.79 14.12 21.76 14.2 21.75C14.44 21.69 14.69 21.64 14.92 21.56C15 21.53 15.08 21.5 15.16 21.48C15.38 21.4 15.61 21.33 15.82 21.24C15.9 21.21 15.98 21.17 16.06 21.13C16.27 21.04 16.48 20.94 16.69 20.83C16.77 20.79 16.84 20.74 16.91 20.7C17.11 20.58 17.31 20.47 17.51 20.34C17.58 20.3 17.64 20.25 17.71 20.2C17.91 20.06 18.1 19.92 18.28 19.77C18.34 19.72 18.39 19.67 18.45 19.63C18.56 19.54 18.67 19.45 18.77 19.36C18.77 19.35 18.77 19.35 18.76 19.34C20.75 17.51 22 14.9 22 12ZM16.94 16.97C14.23 15.15 9.79 15.15 7.06 16.97C6.62 17.26 6.26 17.6 5.96 17.97C4.44 16.43 3.5 14.32 3.5 12C3.5 7.31 7.31 3.5 12 3.5C16.69 3.5 20.5 7.31 20.5 12C20.5 14.32 19.56 16.43 18.04 17.97C17.75 17.6 17.38 17.26 16.94 16.97Z"></path>
                            <path d="M12 6.92969C9.93 6.92969 8.25 8.60969 8.25 10.6797C8.25 12.7097 9.84 14.3597 11.95 14.4197C11.98 14.4197 12.02 14.4197 12.04 14.4197C12.06 14.4197 12.09 14.4197 12.11 14.4197C12.12 14.4197 12.13 14.4197 12.13 14.4197C14.15 14.3497 15.74 12.7097 15.75 10.6797C15.75 8.60969 14.07 6.92969 12 6.92969Z"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <div class="text-base font-medium leading-none text-text-100">{{ user.username }}</div>
                        <!-- <div class="text-sm font-medium leading-none text-gray-400">{{ user.email }}</div> -->
                    </div>
                </div>
                {% endif %}
                <div class="mt-3 space-y-1 px-2">
                {% if user.is_authenticated %}
                    <a href="{% url 'profile' %}" class="block rounded-md px-3 py-2 text-base font-medium text-text-700 dark:text-text-300 hover:bg-accent-200 dark:hover:bg-accent-800 dark:hover:text-text-100">Your Profile</a>
                    <a href="{% url 'profile' %}" class="block rounded-md px-3 py-2 text-base font-medium text-text-700 dark:text-text-300 hover:bg-accent-200 dark:hover:bg-accent-800 dark:hover:text-text-100">Settings</a>
                    <a href="{% url 'logout' %}"  class="block rounded-md px-3 py-2 text-base font-medium text-text-700 dark:text-text-300 hover:bg-accent-200 dark:hover:bg-accent-800 dark:hover:text-text-100">Sign out</a>
                {% else %}
                    <a href="{% url 'login' %}" class="block rounded-md px-3 py-2 text-base font-medium text-text-700 dark:text-text-300 hover:bg-accent-200 dark:hover:bg-accent-800 dark:hover:text-text-100">Log In</a>
                    <a href="{% url 'create_profile' %}" class="block rounded-md px-3 py-2 text-base font-medium text-text-700 dark:text-text-300 hover:bg-accent-200 dark:hover:bg-accent-800 dark:hover:text-text-100">Sign Up</a>
                {% endif %}
                </div>
            </div>
        </div>
    </nav>
</header>
